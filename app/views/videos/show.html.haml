.background
- content_for :facebook_meta do
  = tag :meta, property: "og:type", content: "website"
  = tag :meta, property: "og:url", content: video_url(@video)
  = tag :meta, property: "og:title", content: "셀수스 - #{@video.title}"
  = tag :meta, property: "og:description", content: (@video.body)
.container
  %section
    .content-main
      .row
        .col-sm-7
          = raw @video.iframe_html
          .content-main__sns.text-left
            %a{"data-via" => "twitterdev", :href => "https://twitter.com/share"}
              = image_tag 'btn-tw.png', alt: "트위터버튼"
            %a{:href => "http://www.facebook.com/sharer.php?u=#{video_url(@video)}"}
              = image_tag 'btn-fb.png', alt: "페이스북버튼"
            %a{:href => "https://plus.google.com/share?url=#{video_url(@video)}"}
              = image_tag 'btn-google.png', alt: "구글버튼"
            .fb-like{"data-action" => "like", "data-href" => video_url(@video), "data-layout" => "button", "data-share" => "false", "data-show-faces" => "false"}
        .col-sm-5
          .content-main__spec.content-spec
            .content-spec__title
              = image_tag 'icon-video.png'
              %h3.iblc #{@video.title}
            %p.content-spec__text
              #{@video.body}
            %p.content-spec__text
              = @video.link
            %p.content-spec__text
              - if @video.owner_name
                저작권자 : #{@video.owner_name}
                (
                = link_to @video.check_owner_url, @video.check_owner_url
                )

            - if current_user
              = link_to '#', class: 'content-spec__link', "data-target" => "#warning", "data-toggle" => "modal" do
                저작권 신고하기
                = image_tag 'icon-button.png'
            - else
              = link_to '#', data: { confirm: '로그인 후 이용가능 합니다.'}, class: 'content-spec__link' do
                저작권 신고하기
                = image_tag 'icon-button.png'
            .content-spec__copyright
              - if @video.extra_copyright
                = link_to (@video.copy_right_image_url), @video.copy_right_licence_info_url
              - else
                = link_to image_tag(@video.copy_right_image_url), @video.copy_right_licence_info_url
          .content-main__download.content-download
            %ul.content-download__list
              - if @video.download_links_hash.present?
                - @video.download_links_hash.each do |down|
                  %li.content-size{"data-download-url" => video_download_path(@video, type_quality: down["quality"], type_width: down["width"])}
                    %input.content-size__radio{:type => "radio", name: "video_radio", value: down["quality"]}
                    %span.content-size__option
                      = "#{down['width']} X #{down['height']}"
                    %span.content-size__type
                      = down["type"]
                .content-download__button.text-center{"data-target" => "#myModal", "data-toggle" => "modal", :type => "button"}
                  %a{:href => "#", :role => "button", :class => "iblc", id: 'video-quality-check'} 다운로드
              - else
                .text-center
                  %br
                  = '다운로드를 제공하지 않습니다.'

    .content
      .content-box
        %h4.content-box__title
          ="키워드"
        %p.content-box__description
          - if @video.tags
            - @video.tags.each do |tag|
              %span.label.label-default
                = link_to tag.name, [:tags, :contents, tag: tag.name]

      - if @friendly_videos.present?
        .content-box
          %h4.content-box__title
            ="관련 비디오"
          .content-box__imglist.content-imglist
            .img-list.als-container
              %span.als-prev
                = image_tag 'icon-arrow-left.png', alt: '왼쪽버튼'
              .als-viewport
                %ul.als-wrapper
                  - @friendly_videos.each do |fr_video|
                    %li.als-item
                      = link_to image_tag(fr_video.thumbnail_url), fr_video
              %span.als-next
                = image_tag 'icon-arrow-right.png', alt: '오른쪽버튼'
            .clearfix
      - if @author_videos.present?
        .content-box
          %h4.content-box__title
            ="작가의 최신 비디오"
          .content-box__imglist.content-imglist
            .img-list.als-container
              %span.als-prev
                = image_tag 'icon-arrow-left.png', alt: '왼쪽버튼'
              .als-viewport
                %ul.als-wrapper
                  - @author_videos.each do |author_video|
                    %li.als-item
                      = link_to image_tag(author_video.thumbnail_url), author_video
              %span.als-next
                = image_tag 'icon-arrow-right.png', alt: '오른쪽버튼'
            .clearfix

  %section
    .fb-comments{"data-colorscheme" => "light", "data-href" => video_url(@video), "data-numposts" => "5", "width" => "100%" , "data-width" => "100%"}
  .text-center
    = link_to '목록으로', [:videos], class: 'btn btn-default'


  = render 'warning_modal'
  = render 'social_share_script'

#myModal.modal.fade.download-info{"aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :role => "dialog", :tabindex => "-1"}
  .modal-dialog
    .modal-content
      .modal-header
        %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
          %span{"aria-hidden" => "true"} ×
        %h4#myModalLabel.modal-title 다운로드 이용안내
      .modal-body
        %h3
          %i.fa.fa-check-circle
          현재 다운로드 하시려는 저작물의 제목
        .content-body
          %p= @video.title
        - if @video.owner_name
          %h3
            %i.fa.fa-check-circle
            저작권자
          %p
            #{@video.owner_name}
            (
            = link_to @video.check_owner_url, @video.check_owner_url
            )
        %h3
          %i.fa.fa-check-circle
          사용 허가된 저작권 형태
        %p
          - if @video.extra_copyright
            = link_to (@video.copy_right_image_url), @video.copy_right_licence_info_url
          - else
            = link_to image_tag(@video.copy_right_image_url), @video.copy_right_licence_info_url
          = link_to "자세히보기", @video.copy_right_licence_info_url

        / %h3 추가 유의사항
        / %p
        /   저작물내 모델의 초상권 미해결됨 (연락처 : #{@}         )
        /   저작물내에 포함된 재산권 미해결됨 (연락처 :          )
        .modal-info
          %p
            셀수스에서 제공하는 콘텐츠는 저작권법의 관련 규정에 의하여 저작권을 보호 받습니다.
            %br
            허가된 라이센스의 상세 내용은 위의 상세링크에서 확인해주십시오.

          %p 사용 허가된 저작권은 동영상, 이미지, 오디오와 같은 저작물에 대한 것으로서, 해당 저작물에 포함된 인물의 초상권이나 로고, 캐릭터, 상표와 같은 재산권도 모두 일괄적으로 허가된 것은 아닙니다.

          %p 저작물에 포함된 초상권, 재산권의 해결 여부는 별도로 표시되어 있으며, 만약 미해결 표시가 되어 있다면, 해당 초상권자나 재산권자로부터 이용 허가를 받지 않은 경우입니다.
          %p 이 경우에는 공정이용인 경우에만 사용이 가능하며, 상업적 용도로 사용시에는 반드시 해당 권리자에게 별도의 허가를 받으셔야 합니다.


      .modal-footer
        .agree-area
          = label_tag '본인은 위의 모든 내용을 확인함'
          = check_box_tag('agree-download-info', nil, true)
        .content-download__button
          %a{:href => "#", :role => "button", :class => "iblc", :id => 'content-download-btn' } 다운로드


:javascript
  $(function() {
    $(".content-download").on("click", ".content-size", function(e) {
      var $wrapper = $(e.delegateTarget);
      var url = $(this).data("download-url");
      $(this).find('.content-size__radio').prop('checked', true);
      $("#content-download-btn").attr("href", url);
    });

    $("#video-quality-check").on("click", function(e){
      var checked = false;
      var obj = $(".content-size__radio");
      $.each( obj, function( key, value ) {
        if(value.checked){ checked = true; }
      });

      if(!checked){
        alert("비디오 옵션을 선택해주세요.");
        e.stopPropagation();
      }
    });

    $("#content-download-btn").on("click", function(e){
      var checked = $("#agree-download-info")[0].checked;
      if(!checked){
        alert("동의하기를 체크해주세요.");
        e.preventDefault();
      }
    });
  });


